#!/usr/bin/env bash
#

CMAKE="/usr/local/apps/cmake/current/bin/cmake"
BUILD_TYPE="-DCMAKE_BUILD_TYPE=$(basename $(pwd) | sed 's/\W[a-zA-Z0-9]*//')"
SRC=/tmp/p4/source/main

$CMAKE ../.. $BUILD_TYPE $1 \
	-DODB_PATH=$ODB_ROOT \
	-DCMAKE_PREFIX_PATH=/usr/local/apps/python/2.7 \
	-DCMAKE_C_COMPILER=gcc \
	-DCMAKE_CXX_COMPILER=g++ \
	-DBUILD_SHARED_LIBS=OFF \
	-DCMAKE_INSTALL_PREFIX=/tmp/mak/odb_api/ \
	-DCMAKE_Fortran_COMPILER=/usr/local/apps/pgi/pgi-10.8/linux86-64/10.8/bin/pgf90 \
	-DODB_API_MIGRATOR=ON \
	-DODB_API_PYTHON=ON \
	-DCMAKE_CXX_FLAGS=-fPIC \
	-DCMAKE_C_FLAGS=-fPIC \
	-DECLIB_SOURCE=$SRC/eclib \
	-DBUILD_SHARED_LIBS=OFF \
	-DCMAKE_MODULE_PATH=/usr/local/apps/ecbuild/1.0.10/cmake \
	-DODB_API_FORTRAN=ON \
	-DLINKER_LANGUAGE=Fortran \
	-DPGI_PATH=/usr/local/apps/pgi/pgi\-10.8/linux86-64/current

#	-DODB_API_PYTHON=ON \
#	-DCMAKE_MODULE_PATH=$SRC/ecbuild.main/cmake \
